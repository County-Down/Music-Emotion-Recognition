# Music-Emotion-Recognition
This project is based on the research content of dynamic music emotion recognition.<br/>

## 1.Dataset source
PMEmo Dataset: http://next.zju.edu.cn/archive/pmemo/<br/>
DEAM Dataset: https://cvml.unige.ch/databases/DEAM/<br/>

## 2.Operating Environment
### 2.1 data_preprocessing:
In this part, we adopt `Jupyter Notebook` for data preprocessing and feature dimensionality reduction.<br/>
Python version:
     ```
     Python 3.9.12
     ```<br/>
You can use `install -r requirements.txt` to configure the version of the module you need.
#### Requirements
```
pandas==1.4.2
numpy==1.21.5
matplotlib==3.5.1
scikit-learn==1.0.2
```
### 2.2 Neuro_Networks:
In this part, we will use MATLAB to build the neural network for the data processed by data_preprocessing.<br/>
The parameters of our device are as follows:<br/>
operating system:`Ubuntu 16.04.7 LTS`<br/>
MATLAB:`2023a`<br/>
GPU:`NVIDIA GeForce RTX 2080 Ti`

## 3.Neural_Network Code
  `Main. m` is our main function that we run the code by running it.<br/>
  We invoke the time series modeling code with the following statement. In this step, we will complete the time series modeling and data normalization.<br/>
  ```
    [Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt]=dataset_crossvalind(save_folder,target,frameTime_count_all,dynamic_features_analyze,k,numFeatures);
  ```

 In Main.m, the `neural network` for this study is called as follows:<br/>
 ```
    DSelfAttention(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
      dataset_name,target_name,save_folder, ...
      numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
      validationFrequency,kernel_size1,kernel_size2,channel,k,block_num);
 ```

You can modify the neural network by clicking DSelfAttention.m.<br/>
![{96F63662-6FBE-42BF-8AA0-6B0B612D91D2}](https://github.com/user-attachments/assets/708cc39e-a8b0-485b-93ee-e065558b8f1e)

In this section, we conduct `ablation experiments`:
```
    % % cnn部分
    CNN(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k);
    % bilstm部分
    BiLSTM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k);
    % cnn-bilstm
    CNNBiLSTM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k);
    % cnn-bilstm时间尺度
    TCNNBiLSTM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kerhttps://github.com/github-copilot/signupnel_size1,kernel_size2,channel,k);
    % cnn-bilstm空间尺度
    SCNNBiLSTM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k);
    % cnn部分添加残差
    DCNBiLSTM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k,block_num);
```

  In this section, we test other types of `attention mechanisms`：
  ```
    % cnn添加wsam注意力机制
    DWSAM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k,num_block);
    % cnn添加se+空间注意力机制
    DSESAM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k,num_block);
    % cnn添加cbam注意力机制
    DCBAM(Train_xNorm,Test_xNorm,Validate_xNorm,Train_yNorm,Test_yNorm,Validate_yNorm,yopt, ...
        dataset_name,target_name,save_folder, ...
        numFeatures,numResponses,miniBatchSize,numHiddenUnits,maxEpochs,learning_rate, ...
        validationFrequency,kernel_size1,kernel_size2,channel,k,num_block);
```
